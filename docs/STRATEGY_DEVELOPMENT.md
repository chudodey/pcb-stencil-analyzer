# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

Stencil Analyzer –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ü–µ–Ω–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

1. **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–∞–º–∏ –æ—Ü–µ–Ω–∏–≤–∞—é—Ç —Å–≤–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π `composite_score`
2. **Evaluator —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç** - –ª–µ–≥–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
3. **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –º–µ—Ç—Ä–∏–∫** - –≤—Å–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `composite_score`
4. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—é –∑–æ–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Ü–µ–Ω–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

```
ProcessingStrategy ‚Üí Composite Score ‚Üí StrategyEvaluator ‚Üí Final Score ‚Üí StageRunner ‚Üí Display
```

### –£—Ä–æ–≤–Ω–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

1. **ProcessingStrategy** - —Ä–∞—Å—á–µ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
2. **StrategyEvaluator** - –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞  
3. **StageRunner** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. **ProcessingEngine** - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —ç—Ç–∞–ø–æ–≤

## üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### ProcessingStrategy (–£—Ä–æ–≤–µ–Ω—å 4) - –†–ê–°–°–ß–ò–¢–´–í–ê–ï–¢:
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (`contrast_improvement`, `noise_ratio`, etc.)
- ‚úÖ **composite_score** - –æ—Å–Ω–æ–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ "–õ–µ–≥–∫–∏–µ" –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É

### StrategyEvaluator (–£—Ä–æ–≤–µ–Ω—å 3) - –ö–û–†–†–ï–ö–¢–ò–†–£–ï–¢:
- ‚úÖ **final_score** = composite_score √ó time_penalty
- ‚úÖ –£—á–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—Ä–µ–º—è)
- ‚ùå –ù–ï –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### StageRunner (–£—Ä–æ–≤–µ–Ω—å 2) - –û–¢–û–ë–†–ê–ñ–ê–ï–¢:
- ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –ø–æ final_score –æ—Ç Evaluator
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ —Ç–æ–ª—å–∫–æ –ª—É—á—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —ç—Ç–∞–ø–∞

### ProcessingEngine (–£—Ä–æ–≤–µ–Ω—å 1) - –û–†–ö–ï–°–¢–†–ò–†–£–ï–¢:
- ‚úÖ –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –±–∏–∑–Ω–µ—Å-—Ñ–∞–∑—ã
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞
- ‚ùå –ù–ï –≤–º–µ—à–∏–≤–∞–µ—Ç—Å—è –≤ –æ—Ü–µ–Ω–∫—É —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é

### –£—Ä–æ–≤–µ–Ω—å 1: ProcessingEngine (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```python
# –õ–æ–≥–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
self._report_progress("–§–∞–∑–∞ 4: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è")
self._report_progress("–§–∞–∑–∞ 5: –ë–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è")

# –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
self.debug_fmt.header("–ù–ê–ß–ê–õ–û –û–ë–†–ê–ë–û–¢–ö–ò –°–ö–ê–ù–ê")
self.debug_fmt.success(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ {processing_time:.2f}—Å")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
stats = {
    "–û–±—â–µ–µ –≤—Ä–µ–º—è": f"{processing_time:.2f}—Å",
    "–£—Å–ø–µ—à–Ω—ã–µ —ç—Ç–∞–ø—ã": len(stage_results),
    "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏": len(pipeline_result.strategy_combination)
}
self.debug_fmt.metrics_table("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞", stats)
```

**‚ùå –ß–¢–û –ù–ï –î–ï–õ–ê–¢–¨:**
- –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ –∏—Ö –º–µ—Ç—Ä–∏–∫–∏
- –ù–µ –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –£—Ä–æ–≤–µ–Ω—å 2: StageRunner (–ú–µ–Ω–µ–¥–∂–µ—Ä —ç—Ç–∞–ø–∞)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:** –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —ç—Ç–∞–ø–∞

```python
# –ó–∞–ø—É—Å–∫ —ç—Ç–∞–ø–∞
self.debug_formatter.section(f"–≠—Ç–∞–ø: {stage.value}", phase="–∑–∞–ø—É—Å–∫")
self.debug_formatter.debug(f"–î–æ—Å—Ç—É–ø–Ω–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π: {len(strategies)}", indent=1)

# –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç—Ç–∞–ø–∞
self.debug_formatter.subheader(f"–°–≤–æ–¥–∫–∞ —ç—Ç–∞–ø–∞: {stage.value}", indent=1)

# –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
headers = ["–°—Ç—Ä–∞—Ç–µ–≥–∏—è", "–û—Ü–µ–Ω–∫–∞", "–í—Ä–µ–º—è (—Å)"]
self.debug_formatter.strategy_table_start(headers, "–û—Ü–µ–Ω–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π")

for eval_result in evaluations:
    self.debug_formatter.strategy_table_row(
        eval_result.strategy_name,
        eval_result.quality_score,
        eval_result.strategy_result.processing_time,
        eval_result.quality_score == best_result.quality_score
    )

self.debug_formatter.strategy_table_end(indent=1)

# –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ª—É—á—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
self.debug_formatter.debug(
    f"–õ—É—á—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: {best_result.strategy_name} "
    f"(–æ—Ü–µ–Ω–∫–∞: {best_result.quality_score:.3f})",
    indent=2
)

# –ú–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
if best_result.strategy_result.metrics:
    self.debug_formatter.metrics_table(
        "–ú–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏",
        best_result.strategy_result.metrics,
        indent=2
    )

self.debug_formatter.success(f"–≠—Ç–∞–ø {stage.value} –∑–∞–≤–µ—Ä—à–µ–Ω", indent=1)
```

**‚ùå –ß–¢–û –ù–ï –î–ï–õ–ê–¢–¨:**
- –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –ù–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –£—Ä–æ–≤–µ–Ω—å 3: StrategyEvaluator (–û—Ü–µ–Ω—â–∏–∫)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:** –õ–µ–≥–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ—Ü–µ–Ω–æ–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

```python
def _calculate_realistic_quality_score(self, strategy_result: StrategyResult, 
                                     context: Dict) -> float:
    # 1. –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π composite_score –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    composite_score = strategy_result.metrics.get('composite_score', 0.0)
    
    # 2. –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∞ score
    if composite_score <= 0:
        composite_score = self._calculate_fallback_score(strategy_result, context)
    
    # 3. –õ–µ–≥–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    time_penalty = self._calculate_time_penalty(strategy_result.processing_time)
    final_score = composite_score * time_penalty
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –≤ debug —Ä–µ–∂–∏–º–µ)
    if self.debug_mode:
        self.debug_formatter.debug(
            f"[–ö–æ—Ä—Ä–µ–∫—Ü–∏—è {strategy_result.strategy_name}]: "
            f"composite={composite_score:.3f}, time_penalty={time_penalty:.3f}, "
            f"final={final_score:.3f}",
            indent=3
        )
    
    return max(0.0, min(1.0, final_score))
```

**‚ùå –ß–¢–û –ù–ï –î–ï–õ–ê–¢–¨:**
- –ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### –£—Ä–æ–≤–µ–Ω—å 4: ProcessingStrategy (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏ —Ä–∞—Å—á–µ—Ç –∫–∞—á–µ—Å—Ç–≤–∞

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –º–µ—Ç—Ä–∏–∫:

```python
def _create_metrics_with_guaranteed_composite(self, image: np.ndarray, 
                                            result: np.ndarray) -> Dict[str, Any]:
    """
    –ì–ê–†–ê–ù–¢–ò–†–£–ï–¢ –Ω–∞–ª–∏—á–∏–µ composite_score –≤ –∫–æ—Ä–Ω–µ –º–µ—Ç—Ä–∏–∫.
    """
    # 1. –†–∞—Å—á–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    strategy_metrics = self._calculate_strategy_specific_metrics(image, result)
    
    # 2. –ì–ê–†–ê–ù–¢–ò–Ø: composite_score –≤—Å–µ–≥–¥–∞ –≤ –∫–æ—Ä–Ω–µ
    composite_score = strategy_metrics.get('composite_score', 0.0)
    if composite_score <= 0:
        composite_score = self._calculate_fallback_composite_score(image, result)
    
    # 3. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
    return {
        'composite_score': composite_score,  # ‚Üê –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–û
        'strategy_metrics': strategy_metrics,
        'lean_metrics': self._calculate_lean_metrics(result)
    }
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
# –ó–∞–ø—É—Å–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
self.debug_fmt.section(f"–ó–∞–ø—É—Å–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: {self.name}", phase="START")
self.debug_fmt.debug(f"–¢–∏–ø: {self.__class__.__name__}", indent=1)

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
if hasattr(self, '_current_parameters'):
    self.debug_fmt.debug("–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:", indent=1)
    for param, value in self._current_parameters.items():
        self.debug_fmt.debug(f"{param}: {value}", indent=2)

# –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
self.debug_fmt.debug("–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞...", indent=2)
self.debug_fmt.debug(
    f"composite_score –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω: {composite_score:.3f}",
    indent=3
)

# –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
self.debug_fmt.success(
    f"–£—Å–ø–µ—à–Ω–æ | –ö–∞—á–µ—Å—Ç–≤–æ: {result.metrics.get('composite_score', 0):.3f} | "
    f"–í—Ä–µ–º—è: {execution_time:.3f}—Å",
    indent=1
)

# –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
if result.metrics:
    self.debug_fmt.metrics_table(
        "–ú–µ—Ç—Ä–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
        result.metrics,
        indent=1
    )
```

**‚ùå –ß–¢–û –ù–ï –î–ï–õ–ê–¢–¨:**
- –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –¥—Ä—É–≥–∏–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
- –ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –º–µ—Ç—Ä–∏–∫

## üìã –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ workflow

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç—Ç–∞–ø–∞ –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏–∏:

```log
# 1. ProcessingEngine - –±–∏–∑–Ω–µ—Å-—Ñ–∞–∑–∞
[INFO]  –§–∞–∑–∞ 5: –ë–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è

# 2. StageRunner - –Ω–∞—á–∞–ª–æ —ç—Ç–∞–ø–∞  
[INFO]  [–∑–∞–ø—É—Å–∫] –≠—Ç–∞–ø: BINARIZATION
[DEBUG]   –î–æ—Å—Ç—É–ø–Ω–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π: 3

# 3. AdaptiveOtsuHybridStrategy - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
[INFO]  [START] –ó–∞–ø—É—Å–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: AdaptiveOtsuHybrid
[DEBUG]   –¢–∏–ø: –ì–∏–±—Ä–∏–¥–Ω–∞—è –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è
[DEBUG]   –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
[DEBUG]     block_size: 31
[DEBUG]     morph_kernel_size: 3
[DEBUG]   –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞...
[DEBUG]     composite_score –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω: 0.727
[OK]      –£—Å–ø–µ—à–Ω–æ | –ö–∞—á–µ—Å—Ç–≤–æ: 0.727 | –í—Ä–µ–º—è: 0.245—Å
[DEBUG]   –ú–µ—Ç—Ä–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
          composite_score    : 0.727
          component_count    : 142
          size_uniformity    : 0.854
          noise_ratio        : 0.023

# 4. StrategyEvaluator - –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ—Ü–µ–Ω–∫–∏
[DEBUG]     [–ö–æ—Ä—Ä–µ–∫—Ü–∏—è AdaptiveOtsuHybrid]:
           composite=0.727, time_penalty=0.950, final=0.690

# 5. StageRunner - —Å–≤–æ–¥–∫–∞ —ç—Ç–∞–ø–∞
[INFO]      –°–≤–æ–¥–∫–∞ —ç—Ç–∞–ø–∞: BINARIZATION
[INFO]    –û—Ü–µ–Ω–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–ª—è —ç—Ç–∞–ø–∞: BINARIZATION
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ–°—Ç—Ä–∞—Ç–µ–≥–∏—è                       ‚îÇ   –û—Ü–µ–Ω–∫–∞ ‚îÇ –í—Ä–µ–º—è (—Å)   ‚îÇ
          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
          ‚îÇ‚úì AdaptiveOtsuHybrid            ‚îÇ    0.690 ‚îÇ        0.25 ‚îÇ
          ‚îÇ‚óã AdaptiveThresholding          ‚îÇ    0.520 ‚îÇ        0.18 ‚îÇ
          ‚îÇ‚óã GlobalOtsu                    ‚îÇ    0.310 ‚îÇ        0.05 ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
[DEBUG]     –õ—É—á—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: AdaptiveOtsuHybrid (–æ—Ü–µ–Ω–∫–∞: 0.690)
[DEBUG]       –ú–µ—Ç—Ä–∏–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:
            composite_score    : 0.727
            component_count    : 142
            size_uniformity    : 0.854
[OK]        –≠—Ç–∞–ø BINARIZATION –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

### 1. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç—É—Ä–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 2. –ü—Ä–∞–≥–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏
- Evaluator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –õ–µ–≥–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç–∞

### 3. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–≤–æ–π composite_score
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### 5. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

## üîß Best Practices –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:
- ‚úÖ –í—Å–µ–≥–¥–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–π—Ç–µ composite_score –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –õ–æ–≥–∏—Ä—É–π—Ç–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—á–µ—Ç–∞
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ "–ª–µ–≥–∫–∏–µ" –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤

### –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π:
- ‚úÖ –°–ª–µ–¥—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —É—Ä–æ–≤–Ω—è–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–≤–æ–¥–∞
- ‚úÖ –°–æ–±–ª—é–¥–∞–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫

---

*–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–π v2.1.0*  
*–î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏*